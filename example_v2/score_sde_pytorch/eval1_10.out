WARNING:tensorflow:From /home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/tensorflow_gan/python/estimator/tpu_gan_estimator.py:42: The name tf.estimator.tpu.TPUEstimator is deprecated. Please use tf.compat.v1.estimator.tpu.TPUEstimator instead.

I0209 11:14:31.854277 22627730614080 xla_bridge.py:355] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0209 11:14:31.854508 22627730614080 xla_bridge.py:355] Unable to initialize backend 'cuda': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
I0209 11:14:31.854576 22627730614080 xla_bridge.py:355] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
I0209 11:14:31.856091 22627730614080 xla_bridge.py:355] Unable to initialize backend 'tpu': INVALID_ARGUMENT: TpuPlatform is not available.
I0209 11:14:31.856192 22627730614080 xla_bridge.py:355] Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
W0209 11:14:31.856259 22627730614080 xla_bridge.py:362] No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
I0209 11:14:31.859742 22627730614080 dataset_info.py:358] Load dataset info from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
W0209 11:14:31.865338 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
W0209 11:14:31.865425 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
I0209 11:14:31.865512 22627730614080 dataset_builder.py:351] Reusing dataset cifar10 (/home/yifulu/tensorflow_datasets/cifar10/3.0.2)
I0209 11:14:31.865579 22627730614080 logging_logger.py:35] Constructing tf.data.Dataset cifar10 for split train, from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
W0209 11:14:32.077100 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
W0209 11:14:32.077270 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
I0209 11:14:32.077416 22627730614080 dataset_builder.py:351] Reusing dataset cifar10 (/home/yifulu/tensorflow_datasets/cifar10/3.0.2)
I0209 11:14:32.077515 22627730614080 logging_logger.py:35] Constructing tf.data.Dataset cifar10 for split test, from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
I0209 11:14:34.812134 22627730614080 dataset_info.py:358] Load dataset info from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
W0209 11:14:34.814100 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
W0209 11:14:34.814206 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
I0209 11:14:34.814314 22627730614080 dataset_builder.py:351] Reusing dataset cifar10 (/home/yifulu/tensorflow_datasets/cifar10/3.0.2)
I0209 11:14:34.814385 22627730614080 logging_logger.py:35] Constructing tf.data.Dataset cifar10 for split train, from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
W0209 11:14:34.854589 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
W0209 11:14:34.854744 22627730614080 options.py:503] options.experimental_threading is deprecated. Use options.threading instead.
I0209 11:14:34.854844 22627730614080 dataset_builder.py:351] Reusing dataset cifar10 (/home/yifulu/tensorflow_datasets/cifar10/3.0.2)
I0209 11:14:34.854910 22627730614080 logging_logger.py:35] Constructing tf.data.Dataset cifar10 for split test, from /home/yifulu/tensorflow_datasets/cifar10/3.0.2
I0209 11:14:34.889375 22627730614080 resolver.py:105] Using /tmp/tfhub_modules to cache modules.
I0209 11:14:34.889985 22627730614080 resolver.py:305] Module 'https://tfhub.dev/tensorflow/tfgan/eval/inception/1' already being downloaded by 'gl1513.arc-ts.umich.edu.2194095.2846b9093e714da79a04e8b5d6d361f2'. Waiting.
I0209 11:14:42.278683 22627730614080 run_lib.py:262] begin checkpoint: 10
I0209 11:14:58.865567 22627730614080 run_lib.py:331] experiments/dpm/eval
I0209 11:14:58.902668 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 0
/home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/tensorflow/python/util/nest.py:869: UserWarning: `tf.layers.flatten` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Flatten` instead.
  structure[0], [func(*x) for x in entries],
/home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/keras/legacy_tf_layers/core.py:523: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  return layer.apply(inputs)
/home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/keras/legacy_tf_layers/base.py:573: UserWarning: `layer.updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  _add_elements_to_collection(self.updates, tf.compat.v1.GraphKeys.UPDATE_OPS)
2023-02-09 11:15:42.879260: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 7104320000 exceeds 10% of free system memory.
2023-02-09 11:15:54.160144: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 6914880000 exceeds 10% of free system memory.
2023-02-09 11:16:10.000145: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 13829760000 exceeds 10% of free system memory.
2023-02-09 11:16:49.034973: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 9678720000 exceeds 10% of free system memory.
I0209 11:21:38.934044 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 1
2023-02-09 11:22:11.918681: W tensorflow/core/framework/cpu_allocator_impl.cc:82] Allocation of 7104320000 exceeds 10% of free system memory.
I0209 11:28:08.858675 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 2
I0209 11:34:40.429822 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 3
I0209 11:41:11.916280 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 4
I0209 11:47:43.624931 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 5
I0209 11:54:16.047277 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 6
I0209 12:00:48.076288 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 7
I0209 12:07:20.345803 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 8
I0209 12:13:52.703506 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 9
I0209 12:20:24.643898 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 10
I0209 12:26:55.695837 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 11
I0209 12:33:27.623644 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 12
I0209 12:39:57.825298 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 13
I0209 12:46:29.300832 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 14
I0209 12:53:01.160242 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 15
I0209 12:59:33.632477 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 16
I0209 13:06:04.481924 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 17
I0209 13:12:35.745213 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 18
I0209 13:19:06.693439 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 19
I0209 13:25:36.156241 22627730614080 run_lib.py:334] sampling -- ckpt: 10, round: 20
WARNING:tensorflow:From /home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/tensorflow_gan/python/eval/classifier_metrics.py:1157: calling map_fn_v2 (from tensorflow.python.ops.map_fn) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.map_fn(fn, elems, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.map_fn(fn, elems))
W0209 13:33:26.135360 22627730614080 deprecation.py:614] From /home/yifulu/.conda/envs/dpm/lib/python3.9/site-packages/tensorflow_gan/python/eval/classifier_metrics.py:1157: calling map_fn_v2 (from tensorflow.python.ops.map_fn) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.map_fn(fn, elems, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.map_fn(fn, elems))
I0209 13:33:37.032265 22627730614080 run_lib.py:408] ckpt-10 --- inception_score: 9.080032e+00, FID: 7.906168e+00, KID: 4.607077e-03
